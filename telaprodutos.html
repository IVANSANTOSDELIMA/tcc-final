<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <!-- Metadados e imports de fontes, ícones, estilos e scripts -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="shortcut icon"
      href="../css/img/logoAtualizada.png"
      type="image/x-icon"
    />
    <link rel="stylesheet" href="css/telaProdutos.css" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://rsms.me/" />
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css" />

    <!-- Ícones Flaticon -->
    <link
      rel="stylesheet"
      href="https://cdn-uicons.flaticon.com/2.6.0/uicons-regular-straight/css/uicons-regular-straight.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn-uicons.flaticon.com/2.6.0/uicons-thin-rounded/css/uicons-thin-rounded.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn-uicons.flaticon.com/2.6.0/uicons-thin-chubby/css/uicons-thin-chubby.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn-uicons.flaticon.com/2.6.0/uicons-solid-straight/css/uicons-solid-straight.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn-uicons.flaticon.com/2.6.0/uicons-tdin-rounded/css/uicons-tdin-rounded.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn-uicons.flaticon.com/2.6.0/uicons-bold-straight/css/uicons-bold-straight.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn-uicons.flaticon.com/2.6.0/uicons-regular-rounded/css/uicons-regular-rounded.css"
    />

    <!-- Script de autenticação de usuário -->
    <script type="module" src="integracoes/authMiddleware.js"></script>

    <title>CerealistaSouza</title>
  </head>

  <body>
    <!-- Container principal -->
    <div class="containerTotal">
      <!-- Menu lateral com botões de navegação -->
      <div class="containerButtons">
        <img src="css/img/Logotipo-Cerealista.png" alt="logoLetra" id="logo" />

        <!-- Botões de navegação -->
        <!-- Cada botão redireciona para uma tela específica -->
        <div class="rowbutton">
          <i class="fi fi-rs-apps"></i>
          <button
            type="button"
            onclick="window.location.href='telaInicio.html'"
          >
            Dashboard
          </button>
          <i
            class="fi fi-ss-angle-right"
            style="font-size: 20px; position: absolute; top: 45%; left: 65%"
          ></i>
        </div>
        <div class="rowbutton">
          <i class="fi fi-tr-users"></i>
          <button
            type="button"
            onclick="window.location.href='telafuncionarios.html'"
          >
            Funcionarios
          </button>
          <i
            class="fi fi-ss-angle-right"
            style="font-size: 20px; position: absolute; top: 45%; left: 75%"
          ></i>
        </div>
        <div class="rowbutton">
          <i class="fi fi-tr-boxes"></i>
          <button
            type="button"
            onclick="window.location.href='telaprodutos.html'"
          >
            Estoque
          </button>
        </div>
        <div class="rowbutton">
          <i class="fi fi-tr-chart-line-up"></i>
          <button
            type="button"
            onclick="window.location.href='telarelatoriodeProdutos.html'"
          >
            Movimentações
          </button>
          <i
            class="fi fi-ss-angle-right"
            style="font-size: 20px; position: absolute; top: 45%; left: 80%"
          ></i>
        </div>
        <div class="rowbutton">
          <i class="fi fi-rr-shopping-bag"></i>
          <button
            type="button"
            onclick="window.location.href='telaAddPedido.html'"
          >
            Pedidos
          </button>
          <i
            class="fi fi-ss-angle-right"
            style="font-size: 20px; position: absolute; top: 45%; left: 55%"
          ></i>
        </div>
      </div>

      <!-- Cabeçalho superior -->
      <header id="headersuperior">
        <div class="config">
          <div id="imageUser"><img src="" alt="" /></div>
        </div>
      </header>

      <!-- Área principal -->
      <div class="container">
        <!-- Bloco de filtros -->
        <div class="filtros-bloco">
          <div id="buttonCategory">
            <div class="category-column-1">
              <button id="openButton">+</button>
            </div>
            <div class="category-column">
              <label for="NomeCategoria-produto"><strong>Nome</strong></label>
              <input
                type="search"
                name="NomeCategory"
                class="inputCtg-categoria"
                id="filtro-nome-produto"
                placeholder="Nome do produto"
              />
            </div>
            <div class="category-column">
              <label for="Categoria"><strong>Categoria</strong></label>
              <select
                name="categorias"
                class="inputCtg-categoria"
                id="filtro-categoria"
              >
                <option value="">Todas as categorias</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Tabela com produtos -->
        <div id="headertable-produtos">
          <table id="table" cellspacing="0" cellpadding="5">
            <thead>
              <tr>
                <th>Nome</th>
                <th>Categoria</th>
                <th>quantidade</th>
                <th>Data de entrada</th>
                <th>Preço</th>
                <th>Status</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody>
              <!-- Linhas do estoque serão inseridas aqui dinamicamente -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Aqui iniciam os diálogos (modais) utilizados para cadastro, visualização e edição -->
      <!-- Os diálogos serão organizados posteriormente -->
    </div>

    <!-- Script para manipular eventos de modal, input de descrição e limpeza do formulário -->
    <script>
      const dialog = document.querySelector("#modalDialog-produtos");
      const openButton = document.querySelector("#openButton");
      const closeModal = document.querySelector("#closeModal-produtos");

      // Insere a data atual ao abrir o modal de cadastro de produto
      document.querySelector("#openButton").addEventListener("click", () => {
        const hoje = new Date().toISOString().split("T")[0];
        document.querySelector("#dataEntrada").value = hoje;
        dialog.showModal();
      });

      // Atualiza contador de caracteres para o campo de descrição do produto
      const textareaDescricao = document.querySelector("#complemento-produto");
      const contadorCaracteres = document.querySelector("#contador-caracteres");

      textareaDescricao.addEventListener("input", () => {
        const caracteresDigitados = textareaDescricao.value.length;
        contadorCaracteres.textContent = `${caracteresDigitados}/1000`;
      });

      // Evento para fechar o modal de produto e limpar campos
      document
        .querySelector("#closeModal-produtos")
        .addEventListener("click", () => {
          document.querySelector("#nome-produto").value = "";
          document.querySelector("#categoria-produto").value = "";
          document.querySelector("#dataEntrada").value = "";
          document.querySelector("#preco-produto").value = "";
          document.querySelector("#codigo-participante-produto").value = "";
          document.querySelector("#preview-selected-image").src = "";
          document.querySelector("#file-upload").value = "";
          document.querySelector("#complemento-produto").value = "";
          document.querySelector("#contador-caracteres").textContent = "0/1000";
          dialog.close();
        });
    </script>
  </body>
</html>